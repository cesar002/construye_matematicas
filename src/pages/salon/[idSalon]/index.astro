---
import Layout from "../../../layouts/Layout.astro";
import Titles from "../../../components/Titles.astro";
import Activities from "../../../components/Activities.astro";
import ActividadesService from "../../../dominio/Actividades/services/Actividades.service";
import ActividadesLegacyRepository from "../../../dominio/Actividades/repository/ActividadesLegacy.repository";

const idSalon = Astro.params["idSalon"];

const actividadesService = new ActividadesService(new ActividadesLegacyRepository());

const actividades = await actividadesService.getActividades(idSalon);



function chunkArray(arr: any[], chunkSize: number) {
  const result = [];
  for (let i = 0; i < arr.length; i += chunkSize) {
    result.push(arr.slice(i, i + chunkSize));
  }
  return result;
}


const actividadesGrouped = chunkArray(actividades.results, 3);

---
<Layout title="Construye tus matemÃ¡ticas">
  <Titles title={actividades.results[0].sequenceName} />

  <div>
    <div class="path-wrapper">
      {actividadesGrouped.map((grupo, index) => (
        <>
          <div class="path-row" style="color: rgb(145, 82, 168);">
            {grupo.map((actividad) => (
              <Activities 
                title={actividad.title} 
                href={`${idSalon}/ficha-docente/${actividad.id}`} 
                img={actividad.fileSmallThumbnail || "https://cmsv3dev.potencia.mx/web/content/potencia.cms.learning.sequence.activity/4/image"} 
              />
            ))}
          </div>
          {index < actividadesGrouped.length - 1 && (
            <div class="path-turn d-none d-lg-flex" style="background: rgb(145, 82, 168); border-color: rgb(145, 82, 168);"></div>
          )}
        </>
      ))}
    </div>
  </div>
</Layout>

